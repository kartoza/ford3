{% extends 'base.html' %}
{% load static %}

{% block title %}
{% if form.name is False %}
     Add provider
{% else %}
    {{ form.instance.name }} â€¢ Edit provider
{% endif %}
{% endblock %}

{% block side_navbar %}
{% if form.instance.id is None %}
    {% include 'dashboard/dashboard_sidebar.html' %}
{% else %}
    <nav id="sidebar"
    class="col-md-3 col-lg-3 col-xl-2 px-0 d-none d-sm-none d-lg-block">
    {% include 'main_sidebar.html' with provider=form.instance %}
    </nav>
{% endif %}

{% endblock %}

{% block body %}
    <div class='row'>
        <div class='col-md-12'>
            {% if not form.instance.name %}
                <h3>Add a provider</h3>
            {% endif %}
        </div>
    </div>


    <div class="row">
        <div class='col-md-12'>
            <h4>Provider Details</h4>
            <hr />
        </div>
    </div>

    <div class="row">
        <div class='col-md-12 p-0'>
            <form class='container' action="{{ submit_url }}" method="post" enctype="multipart/form-data">
                {% csrf_token %}
                   {% if provider_error|length > 0 %}
                    <div id='provider-error' class="alert alert-danger">{{ provider_error }}</div>
                    {% endif %}
                <div class='row'>
                    <div class='col-md-4'>
                        <label>Provider's name <span class="text-danger">*</span> </label>
                        {{ form.name.errors }}
                    </div>
                    <div class='col-md-8'>
                        {{ form.name }}
                    </div>
                </div>
                <div class='row my-5'>
                    <div class='col-md-4'>
                        <label>Provider's logo</label>
                        <p class='text-muted'>Max size: 100 Kb</p>
                        {% if form.provider_logo %}
                            <p class="form_provider_logo">{{ form.provider_logo }}</p>
                        {% endif %}
                        {{ form.provider_logo.errors }}
                    </div>
                    <div class='col-md-8'>
                        <div class="provider-form-photo">
                            {% if form.instance.provider_logo %}
                                <img src="{{ form.instance.provider_logo.url }}" />
                            {% endif %}
                        </div>
                    </div>
                </div>
                <div class="row my-3">
                    <div class="col-md-4">
                        <label>Province <span class="text-danger">*</span></label>
                        {{ form.province.errors }}
                    </div>
                    <div class="col-md-8">
                        {{ form.province }}
                    </div>
                </div>

                <div class="row my-3">
                    <div class="col-md-4">
                        <label>Provider type <span class="text-danger">*</span></label>
                        {{ form.provider_type.errors }}
                    </div>
                    <div class="col-md-8">
                        {{ form.provider_type }}
                    </div>
                </div>
                <div class="row my-3">
                    <div class='col-md-12'>
                        <h4>Central Office Contact Details</h4>
                        <hr />
                    </div>
                </div>

                <div class="row my-3">
                    <div class="col-md-4">
                        <label>Switchboard <span class="text-danger">*</span></label>
                        {{ form.telephone.errors }}
                    </div>
                    <div class="col-md-8">
                        {{ form.telephone }}
                        {{ form.telephone.errors }}
                    </div>
                </div>
                <div class="row my-3">
                    <div class="col-md-4">
                        <label>Admissions <span class="text-danger">*</span></label>
                        {{ form.admissions_contact_no.errors }}
                    </div>
                    <div class="col-md-8">
                        {{ form.admissions_contact_no }}
                        {{ form.admissions_contact_no.errors }}
                    </div>
                </div>
                <div class="row my-3">
                    <div class="col-md-4">
                        <label>Website</label>
                        {{ form.website.errors }}
                    </div>
                    <div class="col-md-8">
                        {{ form.website }}
                    </div>
                </div>
                <div class="row my-3">
                    <div class="col-md-4">
                        <label>E-mail address <span class="text-danger">*</span></label>
                        {{ form.email.errors }}
                    </div>
                    <div class="col-md-8">
                        {{ form.email }}
                    </div>
                </div>
	            <div class="row my-3">
		            <div class="col-md-4">
			            <label>Please select your location</label><br>
			            Use the search function to find your address.<br>
			            If your address is not present:<ul>
			            <li>Use the search function to find the general area</li>
			            <li>Click on the map to pinpoint the location.</li>
			            <li>Update your physical address.</li></ul>
		            </div>
		            <div id="address_map" class="col rounded my-2"
			                 tabindex="0"></div>
	            </div>

                <div class="row my-3">
                    <div class="col-md-4">
                        <label>Physical address <span class="text-danger">*</span></label>
                    </div>
                    <div class="col-md-8">
                        <div class='my-2'>
                            {{ form.physical_address_line_1.errors }}
                            {{ form.physical_address_line_1 }}
                        </div>
                        <div class='my-2'>
                            {{ form.physical_address_line_2.errors }}
                            {{ form.physical_address_line_2 }}
                        </div>
                        <div class="row">
                            <div class="col-lg-7 col-sm-12 mt-1">
                                {{ form.physical_address_city.errors}}
                                {{ form.physical_address_city}}
                            </div>
                            <div class="col-lg-5 col-sm-12 mt-1">
                                {{ form.physical_address_postal_code.errors}}
                                {{ form.physical_address_postal_code }}
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row my-3">
                    <div class="col-md-12">
                        <label class="checkbox-container">
                            The postal address differs from the physical address
                            {{  form.postal_address_differs }}
                            <span class="checkmark"></span>
                        </label>
                    </div>
                </div>
                <div id="postal_address_container" class="row my-3">
                    <div class="col-md-4">
                        <label>Postal address</label>
                    </div>
                    <div class="col-md-8">
                        <div class='my-2'>
                            {{ form.postal_address_line_1.errors }}
                            {{ form.postal_address_line_1 }}
                        </div>
                        <div class='my-2'>
                            {{ form.postal_address_line_2.errors }}
                            {{ form.postal_address_line_2 }}
                        </div>
                        <div class="row">
                            <div class="col-lg-7 col-sm-12 mt1">
                                {{ form.postal_address_city.errors}}
                                {{ form.postal_address_city}}
                            </div>
                            <div class="col-lg-5 col-sm-12 mt1">
                                {{ form.postal_address_postal_code.errors}}
                                {{ form.postal_address_postal_code }}
                            </div>
                        </div>
                    </div>
                </div>
                <div class='row'>
                    <div class='col-md-12'>
                        <hr />
                    </div>
                    <div class='col-md-4'>
                        <button type="submit" class="edu-button edu-button-blue">Submit</button>
                    </div>
                </div>
                <input type="hidden" id="id_location_value_x" name="location_value_x" value="{{ form.initial.location_value_x }}">
                <input type="hidden" id="id_location_value_y" name="location_value_y" value="{{ form.initial.location_value_y }}">
            </form>
        </div>
    </div>

{% endblock body %}

{% block footer %}
	<script src="https://unpkg.com/openlayers@4.6.5/dist/ol.js"></script>
	<script src="https://unpkg.com/ol-popup@2.0.0/src/ol-popup.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/ol-geocoder"></script>

	<link rel="stylesheet"
	      href="https://cdn.rawgit.com/openlayers/openlayers.github.io/master/en/v5.3.0/css/ol.css"
	      type="text/css">
	<link href="https://cdn.jsdelivr.net/npm/ol-geocoder@latest/dist/ol-geocoder.min.css"
	      rel="stylesheet">
	<link href="https://unpkg.com/ol-popup@2.0.0/src/ol-popup.css"
	      rel="stylesheet">
	<link rel="stylesheet" type="text/css"
	      href="{% static 'css/map.css' %}">
	<script type="text/javascript"
	        src="{% static 'js/provider_form.js' %}"></script>
	<script src="{% static 'js/map.js' %}"></script>
	<script src="{% static 'js/provider_form_location.js' %}"></script>

{% endblock %}
